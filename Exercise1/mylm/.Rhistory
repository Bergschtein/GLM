install.packages("car")
library(car)
data(SLID, package = "carData")
SLID <- SLID[complete.cases(SLID), ]
knitr::opts_chunk$set(echo = TRUE)
library(car)
data(SLID, package = "carData")
SLID <- SLID[complete.cases(SLID), ]
library(GGally)
ggpairs(SLID)
View(SLID)
knitr::opts_chunk$set(echo = TRUE)
library(GGally)
library(car)
data(SLID, package = "carData")
SLID <- SLID[complete.cases(SLID), ]
ggpairs(SLID)
install.packages("car")
install.packages("car")
library(car)
library(GGally)
ggpairs(SLID)
head(SLID)
?SLID
model1b <- lm(wages ~ education, data = SLID)
print(model1b)
mylm <- function(formula, data = list(), contrasts = NULL, ...){
# Extract model matrix & responses
mf <- model.frame(formula = formula, data = data)
X  <- model.matrix(attr(mf, "terms"), data = mf, contrasts.arg = contrasts)
y  <- model.response(mf)
terms <- attr(mf, "terms")
#Make necessary calculations to obtain coefficients, residuals, fitted values, etc...
Bhat <- solve(t(X)%*%X)%*%t(X)%*%y
mat <- diag(solve(t(X)%*%X))
Sigmahat <- 1/2* t(y-X%*%Bhat)%*%(y-X%*%Bhat)
Bhat_var <- sqrt(Sigmahat) %*% mat
# Add code here to calculate coefficients, residuals, fitted values, etc...
# and store the results in the list est
est <- list(terms = terms, model = mf)
# Store call and formula used
est$call <- match.call()
est$formula <- formula
# Set class name. This is very important!
class(est) <- 'mylm'
# Return the object with all results
return(est)
}
# Add code here to calculate coefficients, residuals, fitted values, etc...
# and store the results in the list est
est <- list(terms = terms, model = mf)
# Store call and formula used
est$call <- match.call()
mylm <- function(formula, data = list(), contrasts = NULL, ...){
# Extract model matrix & responses
mf <- model.frame(formula = formula, data = data)
X  <- model.matrix(attr(mf, "terms"), data = mf, contrasts.arg = contrasts)
y  <- model.response(mf)
terms <- attr(mf, "terms")
#Make necessary calculations to obtain coefficients, residuals, fitted values, etc...
Bhat <- solve(t(X)%*%X)%*%t(X)%*%y
mat <- diag(solve(t(X)%*%X))
Sigmahat <- 1/2* t(y-X%*%Bhat)%*%(y-X%*%Bhat)
Bhat_var <- sqrt(Sigmahat) %*% mat
# Add code here to calculate coefficients, residuals, fitted values, etc...
# and store the results in the list est
est <- list(terms = terms, model = mf)
# Store call and formula used
est$call <- match.call()
est$formula <- formula
# Set class name. This is very important!
class(est) <- 'mylm'
# Return the object with all results
return(est)
}
devtools::load_all(".")
library(mylm)
setwd("/Users/johanvikmathisen/Desktop/Fag/Matematikk/Generaliserte lineære modeller/Exercise1")
library(knitr)
knitr::opts_chunk$set(echo = TRUE,tidy=TRUE,message=FALSE,warning=FALSE,strip.white=TRUE,prompt=FALSE,
cache=FALSE, size="scriptsize",fig.width=4, fig.height=3,fig.align = "center")
library(car)
library(ggplot2)
library(GGally)
library(mylm)
data(SLID, package = "carData")
SLID <- SLID[complete.cases(SLID), ]
ggpairs(SLID)
model1 <- mylm(wages ~ education, data = SLID)
print.mylm(model1)
model1b <- lm(wages ~ education, data = SLID)
print(model1b)
summary.mylm(model1)
summary(model1b)
model2 <- mylm(wages ~ education + age, data = SLID)
summary.mylm(model2)
summary_Table=data.frame(matrix(c(model2$SE,model2$p),ncol=2,byrow = FALSE))
library(mylm)
setwd("/Users/johanvikmathisen/Desktop/Fag/Matematikk/Generaliserte lineære modeller/Exercise1")
library(knitr)
knitr::opts_chunk$set(echo = TRUE,tidy=TRUE,message=FALSE,warning=FALSE,strip.white=TRUE,prompt=FALSE,
cache=FALSE, size="scriptsize",fig.width=4, fig.height=3,fig.align = "center")
library(car)
library(ggplot2)
library(GGally)
library(mylm)
data(SLID, package = "carData")
SLID <- SLID[complete.cases(SLID), ]
ggpairs(SLID)
model1 <- mylm(wages ~ education, data = SLID)
print.mylm(model1)
model1 <- mylm(wages ~ education, data = SLID)
print.mylm(model1)
model1b <- lm(wages ~ education, data = SLID)
print(model1b)
model4 <- mylm(wages~sex + age + language + I(education)^2, data=SLID)
model4 <- mylm(wages~sex + age + language + I(education)^2, data=SLID)
summary.mylm(model4)
model4 <- mylm(wages~sex + age + language + I(education)^2, data=SLID)
model4_lm <- lm(wages~sex + age + language + I(education)^2, data=SLID)
summary.mylm(model4)
summary.lm(model4_lm)
model4 <- mylm(wages~sex + age + language + I(education)^2, data=SLID)
summary.mylm(model4)
model4_lm <- lm(wages~sex + age + language + I(education)^2, data=SLID)
summary.lm(model4_lm)
model5_lm <- lm(wages~ age + language + age*language, data=SLID)
summary-lm(model5_lm)
model5_lm <- lm(wages~ age + language + age*language, data=SLID)
summary.lm(model5_lm)
model5 <- mylm(wages~ age + language + age*language, data=SLID)
summary.mylm(model5)
model4 <- mylm(wages~sex + age + language + I(education)^2, data=SLID)
model5 <- mylm(wages~ age + language + age*language, data=SLID)
model6 <- mylm(wages~ education -1, data=SLID)
summary.mylm(model4)
summary.mylm(model5)
summary.mylm(model6)
model4 <- mylm(wages~sex + age + language + I(education)^2, data=SLID)
model5 <- mylm(wages~ age + language + age*language, data=SLID)
model6 <- mylm(wages~ education -1, data=SLID)
#summary.mylm(model4)
#summary.mylm(model5)
summary.mylm(model6)
model4 <- mylm(wages~sex + age + language + I(education)^2, data=SLID)
model5 <- mylm(wages~ age + language + age*language, data=SLID)
model6 <- mylm(wages~ education -1, data=SLID)
model4_lm <- lm(wages~sex + age + language + I(education)^2, data=SLID)
model5_lm <- lm(wages~ age + language + age*language, data=SLID)
model6_lm <- lm(wages~ education -1, data=SLID)
summary.mylm(model4)
summary.mylm(model5)
summary.lm(model5_lm)
summary.mylm(model6)
summary.lm(model6_lm)
setwd("/Users/johanvikmathisen/Desktop/Fag/Matematikk/Generaliserte lineære modeller/Exercise1")
library(knitr)
knitr::opts_chunk$set(echo = TRUE,tidy=TRUE,message=FALSE,warning=FALSE,strip.white=TRUE,prompt=FALSE,
cache=FALSE, size="scriptsize",fig.width=4, fig.height=3,fig.align = "center")
library(car)
library(ggplot2)
library(GGally)
library(mylm)
data(SLID, package = "carData")
SLID <- SLID[complete.cases(SLID), ]
ggpairs(SLID)
model1 <- mylm(wages ~ education, data = SLID)
print.mylm(model1)
model1b <- lm(wages ~ education, data = SLID)
print(model1b)
summary.mylm(model1)
summary(model1b)
model2 <- mylm(wages ~ education + age, data = SLID)
summary.mylm(model2)
summary_Table=data.frame(matrix(c(model2$SE,model2$p),ncol=2,byrow = FALSE))
colnames(summary_Table) <- c('Std. Error', 'p-value')
rownames(summary_Table) <- rownames(model2$coefficients)
print(summary_Table)
#model wages~education
summary.mylm(model1)
#model wages~age
model3 <- mylm(wages~age, data=SLID)
summary.mylm(model3)
model4 <- mylm(wages~sex + age + language + I(education)^2, data=SLID)
model5 <- mylm(wages~ age + language + age*language, data=SLID)
model6 <- mylm(wages~ education -1, data=SLID)
model4_lm <- lm(wages~sex + age + language + I(education)^2, data=SLID)
model5_lm <- lm(wages~ age + language + age*language, data=SLID)
model6_lm <- lm(wages~ education -1, data=SLID)
summary.mylm(model4)
summary.lm(model4_lm)
summary.mylm(model5)
summary.lm(model5_lm)
plot.mylm(model6)
setwd("/Users/johanvikmathisen/Desktop/Fag/Matematikk/Generaliserte lineære modeller/Exercise1")
library(knitr)
knitr::opts_chunk$set(echo = TRUE,tidy=TRUE,message=FALSE,warning=FALSE,strip.white=TRUE,prompt=FALSE,
cache=FALSE, size="scriptsize",fig.width=4, fig.height=3,fig.align = "center")
library(car)
library(ggplot2)
library(GGally)
library(mylm)
data(SLID, package = "carData")
SLID <- SLID[complete.cases(SLID), ]
ggpairs(SLID)
model1 <- mylm(wages ~ education, data = SLID)
print.mylm(model1)
model1b <- lm(wages ~ education, data = SLID)
print(model1b)
summary.mylm(model1)
summary(model1b)
model2 <- mylm(wages ~ education + age, data = SLID)
summary.mylm(model2)
summary_Table=data.frame(matrix(c(model2$SE,model2$p),ncol=2,byrow = FALSE))
colnames(summary_Table) <- c('Std. Error', 'p-value')
rownames(summary_Table) <- rownames(model2$coefficients)
print(summary_Table)
#model wages~education
summary.mylm(model1)
#model wages~age
model3 <- mylm(wages~age, data=SLID)
summary.mylm(model3)
model4 <- mylm(wages~sex + age + language + I(education)^2, data=SLID)
model5 <- mylm(wages~ age + language + age*language, data=SLID)
model6 <- mylm(wages~ education -1, data=SLID)
model4_lm <- lm(wages~sex + age + language + I(education)^2, data=SLID)
model5_lm <- lm(wages~ age + language + age*language, data=SLID)
model6_lm <- lm(wages~ education -1, data=SLID)
summary.mylm(model4)
summary.lm(model4_lm)
summary.mylm(model5)
summary.lm(model5_lm)
plot.mylm(model6)
summary.lm(model5_lm)
plot.mylm(model6)
library(mylm)
setwd("/Users/johanvikmathisen/Desktop/Fag/Matematikk/Generaliserte lineære modeller/Exercise1")
library(knitr)
knitr::opts_chunk$set(echo = TRUE,tidy=TRUE,message=FALSE,warning=FALSE,strip.white=TRUE,prompt=FALSE,
cache=FALSE, size="scriptsize",fig.width=4, fig.height=3,fig.align = "center")
setwd("/Users/johanvikmathisen/Desktop/Fag/Matematikk/Generaliserte lineære modeller/Exercise1")
library(knitr)
knitr::opts_chunk$set(echo = TRUE,tidy=TRUE,message=FALSE,warning=FALSE,strip.white=TRUE,prompt=FALSE,
cache=FALSE, size="scriptsize",fig.width=4, fig.height=3,fig.align = "center")
library(car)
library(ggplot2)
library(GGally)
library(mylm)
setwd("/Users/johanvikmathisen/Desktop/Fag/Matematikk/Generaliserte lineære modeller/Exercise1")
library(knitr)
knitr::opts_chunk$set(echo = TRUE,tidy=TRUE,message=FALSE,warning=FALSE,strip.white=TRUE,prompt=FALSE,
cache=FALSE, size="scriptsize",fig.width=4, fig.height=3,fig.align = "center")
library(car)
library(ggplot2)
library(GGally)
library(mylm)
data(SLID, package = "carData")
SLID <- SLID[complete.cases(SLID), ]
ggpairs(SLID)
model1 <- mylm(wages ~ education, data = SLID)
print.mylm(model1)
model1b <- lm(wages ~ education, data = SLID)
print(model1b)
summary.mylm(model1)
summary(model1b)
model2 <- mylm(wages ~ education + age, data = SLID)
summary.mylm(model2)
summary_Table=data.frame(matrix(c(model2$SE,model2$p),ncol=2,byrow = FALSE))
colnames(summary_Table) <- c('Std. Error', 'p-value')
rownames(summary_Table) <- rownames(model2$coefficients)
print(summary_Table)
#model wages~education
summary.mylm(model1)
#model wages~age
model3 <- mylm(wages~age, data=SLID)
summary.mylm(model3)
model4 <- mylm(wages~sex + age + language + I(education)^2, data=SLID)
model5 <- mylm(wages~ age + language + age*language, data=SLID)
model6 <- mylm(wages~ education -1, data=SLID)
model4_lm <- lm(wages~sex + age + language + I(education)^2, data=SLID)
model5_lm <- lm(wages~ age + language + age*language, data=SLID)
model6_lm <- lm(wages~ education -1, data=SLID)
summary.mylm(model4)
summary.lm(model4_lm)
summary.mylm(model5)
summary.lm(model5_lm)
plot.mylm(model6)
plot.lm(model6_lm)
plot(model6_lm)
summary.mylm(model6)
library(mylm)
setwd("/Users/johanvikmathisen/Desktop/Fag/Matematikk/Generaliserte lineære modeller/Exercise1")
library(knitr)
knitr::opts_chunk$set(echo = TRUE,tidy=TRUE,message=FALSE,warning=FALSE,strip.white=TRUE,prompt=FALSE,
cache=FALSE, size="scriptsize",fig.width=4, fig.height=3,fig.align = "center")
library(car)
library(ggplot2)
library(GGally)
library(mylm)
data(SLID, package = "carData")
SLID <- SLID[complete.cases(SLID), ]
ggpairs(SLID)
model1 <- mylm(wages ~ education, data = SLID)
print.mylm(model1)
model1b <- lm(wages ~ education, data = SLID)
print(model1b)
summary.mylm(model1)
summary(model1b)
model2 <- mylm(wages ~ education + age, data = SLID)
summary.mylm(model2)
summary_Table=data.frame(matrix(c(model2$SE,model2$p),ncol=2,byrow = FALSE))
colnames(summary_Table) <- c('Std. Error', 'p-value')
rownames(summary_Table) <- rownames(model2$coefficients)
print(summary_Table)
#model wages~education
summary.mylm(model1)
#model wages~age
model3 <- mylm(wages~age, data=SLID)
summary.mylm(model3)
model4 <- mylm(wages~sex + age + language + I(education)^2, data=SLID)
model5 <- mylm(wages~ age + language + age*language, data=SLID)
model6 <- mylm(wages~ education -1, data=SLID)
model4_lm <- lm(wages~sex + age + language + I(education)^2, data=SLID)
model5_lm <- lm(wages~ age + language + age*language, data=SLID)
model6_lm <- lm(wages~ education -1, data=SLID)
summary.mylm(model4)
summary.lm(model4_lm)
summary.mylm(model5)
summary.lm(model5_lm)
plot.mylm(model6)
summary.mylm(model6)
plot(model6_lm)
#plot.mylm(model6)
model6$fitted_values
#summary.mylm(model6)
#plot.mylm(model6)
model6_lm$fitted_values
#summary.mylm(model6)
plot.mylm(model6)
#model6_lm$fitted_values
#summary.mylm(model6)
plot(model6_lm)
summary.lm(model6_lm)
plot.mylm(model4)
summary.mylm(model4)
plot.mylm(model4)
plot(model4_lm)
summary.mylm(model4)
library(mylm)
setwd("/Users/johanvikmathisen/Desktop/Fag/Matematikk/Generaliserte lineære modeller/Exercise1")
library(knitr)
knitr::opts_chunk$set(echo = TRUE,tidy=TRUE,message=FALSE,warning=FALSE,strip.white=TRUE,prompt=FALSE,
cache=FALSE, size="scriptsize",fig.width=4, fig.height=3,fig.align = "center")
library(car)
library(ggplot2)
library(GGally)
library(mylm)
data(SLID, package = "carData")
SLID <- SLID[complete.cases(SLID), ]
#ggpairs(SLID)
model1 <- mylm(wages ~ education, data = SLID)
print.mylm(model1)
model1b <- lm(wages ~ education, data = SLID)
print(model1b)
summary.mylm(model1)
summary(model1b)
model2 <- mylm(wages ~ education + age, data = SLID)
summary.mylm(model2)
summary_Table=data.frame(matrix(c(model2$SE,model2$p),ncol=2,byrow = FALSE))
colnames(summary_Table) <- c('Std. Error', 'p-value')
rownames(summary_Table) <- rownames(model2$coefficients)
print(summary_Table)
#model wages~education
summary.mylm(model1)
#model wages~age
model3 <- mylm(wages~age, data=SLID)
summary.mylm(model3)
model4 <- mylm(wages~sex + age + language + I(education)^2, data=SLID)
model5 <- mylm(wages~ age + language + age*language, data=SLID)
model6 <- mylm(wages~ education -1, data=SLID)
model4_lm <- lm(wages~sex + age + language + I(education)^2, data=SLID)
model5_lm <- lm(wages~ age + language + age*language, data=SLID)
model6_lm <- lm(wages~ education -1, data=SLID)
plot.mylm(model4)
plot(model4_lm)
summary.mylm(model4)
plot.mylm(model5)
summary.mylm(model5)
plot(model5_lm)[1]
summary.lm(model5_lm)
plot(model5_lm)[[1]]
summary.lm(model5_lm)
plot(model5_lm)["Residual vs fitted"]
summary.lm(model5_lm)
plot(model5_lm)[["Residual vs fitted"]]
summary.lm(model5_lm)
plot(model5_lm, which = 1)
summary.lm(model5_lm)
library(mylm)
library(mylm)
library(mylm)
library(mylm)
setwd("/Users/johanvikmathisen/Desktop/Fag/Matematikk/Generaliserte lineære modeller/Exercise1")
library(knitr)
knitr::opts_chunk$set(echo = TRUE,tidy=TRUE,message=FALSE,warning=FALSE,strip.white=TRUE,prompt=FALSE,
cache=FALSE, size="scriptsize",fig.width=4, fig.height=3,fig.align = "center")
?I()
library(mylm)
?cat()
library(mylm)
library(mylm)
knit_with_parameters("~/Desktop/Fag/Matematikk/Generaliserte lineære modeller/Exercise1/Project_one_glm_Johan.rmd")
library(mylm)
